
sample_rate: 16000
sslmodel_hub: facebook/wav2vec2-base
sslmodel_folder: /content/ssl_checkpoint

freeze_ssl: False
freeze_ssl_conv: True

encoder_dim: 768
out_n_neurons: 5

label_encoder: !new:speechbrain.dataio.encoder.CategoricalEncoder
ssl_model: !new:speechbrain.lobes.models.huggingface_transformers.wav2vec2.Wav2Vec2
    source: !ref <sslmodel_hub>
    output_norm: True
    freeze: !ref <freeze_ssl>
    freeze_feature_extractor: !ref <freeze_ssl_conv>
    save_path: !ref <sslmodel_folder>

avg_pool: !new:speechbrain.nnet.pooling.StatisticsPooling
    return_std: False

output_mlp: !new:speechbrain.nnet.linear.Linear
    input_size: !ref <encoder_dim>
    n_neurons: !ref <out_n_neurons>
    bias: False

log_softmax: !new:speechbrain.nnet.activations.Softmax
    apply_log: True

modules:
    ssl_model: !ref <ssl_model>
    avg_pool: !ref <avg_pool>
    log_softmax: !ref <log_softmax>
    output_mlp: !ref <output_mlp>

model: !new:torch.nn.ModuleList
    - [!ref <output_mlp>]


pretrainer: !new:speechbrain.utils.parameter_transfer.Pretrainer
  loadables:
      ssl_model: !ref <ssl_model>
      model: !ref <model>
      label_encoder: !ref <label_encoder>
